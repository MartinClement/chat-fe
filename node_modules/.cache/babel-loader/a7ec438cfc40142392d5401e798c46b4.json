{"ast":null,"code":"import _defineProperty from \"/Users/clement/web/chat-ws/chat/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/Users/clement/web/chat-ws/chat/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/clement/web/chat-ws/chat/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/clement/web/chat-ws/chat/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/clement/web/chat-ws/chat/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/clement/web/chat-ws/chat/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/clement/web/chat-ws/chat/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _taggedTemplateLiteral from \"/Users/clement/web/chat-ws/chat/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/clement/web/chat-ws/chat/src/components/Chat.js\";\n\nfunction _templateObject7() {\n  var data = _taggedTemplateLiteral([\"\\n  background-color: #424242;\\n  color: #fff;\\n  width: 100%;\\n  height: 40px;\\n  box-sizing: border-box;\\n  &:focus {\\n    outline: none;\\n  }\\n\\n  &:-webkit-autofill,\\n  &:-webkit-autofill:hover,\\n  &:-webkit-autofill:focus,\\n  &:-webkit-autofill:active {\\n    transition: all 5000s ease-in-out 0s;\\n  }\\n\"]);\n\n  _templateObject7 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  var data = _taggedTemplateLiteral([\"\\n  color: \", \";\\n  font-size: 16px;\\n  font-weight: 600;\\n  margin-right: 10px;\\n\"]);\n\n  _templateObject6 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"\\n  color: #fff;\\n  font-size: 16px;\\n  padding: 20px 0 20px 10px;\\n  display: flex;\\n  border-bottom: 1px solid #cfcfcf;\\n  position: relative;\\n\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  flex-grow: 1;\\n  padding: 40px 0;\\n  overflow-y: scroll;\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n    color: \", \"\\n    font-size: 18px;\\n    margin-left: 5px;\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n    color: \", \"\\n    font-weight: 600;\\n    font-size: 18px;\\n    position: absolute;\\n    top: 0px;\\n    left: 0px;\\n    right: 0px;\\n    padding: 10px;\\n    border: 2px solid #fff;\\n    display: flex;\\n    background-color: #424242;\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 100vw;\\n  height: 100vh;\\n  background: #424242;\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  font-size: 16px;\\n  color: #fff;\\n  font-family: Arial, sans-serif;\\n\\n  & > * {\\n    padding: 10px;\\n    border: 3px solid #fff;\\n    border-radius: 3px;\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React from 'react';\nimport styled from 'styled-components';\nimport { Spring, config } from 'react-spring';\nvar Wrapper = styled.div(_templateObject());\nvar Status = styled.div(_templateObject2(), function (p) {\n  return p.status === 'disconnected' ? 'red' : p.status === 'connection ...' ? 'orange' : 'green';\n});\nvar Name = styled.div(_templateObject3(), function (p) {\n  return p.color;\n});\nvar Messages = styled.div(_templateObject4());\nvar Msg = styled.div(_templateObject5());\nvar Author = styled.div(_templateObject6(), function (p) {\n  return p.color;\n});\nvar Input = styled.input(_templateObject7());\n\nvar Chat =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Chat, _React$Component);\n\n  function Chat() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Chat);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Chat)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this._connection = null;\n    _this._input = React.createRef();\n    _this._message = React.createRef();\n    _this._MO = null;\n    _this.state = {\n      status: '',\n      error: '',\n      chatHistory: [],\n      input: '',\n      name: null,\n      color: ''\n    };\n\n    _this.scrollToBottom = function () {\n      _this._message.current.scrollTop = _this._message.current.scrollHeight;\n    };\n\n    _this.componentWillMount = function () {\n      var connection = _this.props.connection;\n      _this._connection = connection;\n      _this._connection.onopen = _this.handleConnectionOpen;\n      _this._connection.onerror = _this.handleConnectionError;\n      _this._connection.onmessage = _this.handleConnectionMessage;\n    };\n\n    _this.handleSubmit = function (e) {\n      var v = _this._input.current.value;\n      var name = _this.state.name;\n\n      if (v !== '' && e.keyCode === 13) {\n        _this._connection.send(v);\n\n        _this.setState(function (prev) {\n          return {\n            name: prev.name ? prev.name : v,\n            input: '',\n            status: 'connected'\n          };\n        });\n      }\n    };\n\n    _this.handleConnectionOpen = function () {\n      _this.setState({\n        status: 'connection ...'\n      });\n    };\n\n    _this.handleConnectionError = function (err) {\n      console.log('connection error', err);\n\n      _this.setState({\n        status: 'disconnected',\n        error: 'Connection failed'\n      });\n    };\n\n    _this.handleConnectionMessage = function (msg) {\n      var chatHistory = _this.state.chatHistory;\n\n      try {\n        var json = JSON.parse(msg.data);\n      } catch (e) {\n        console.log('Invalid JSON: ', msg.data);\n        return;\n      }\n\n      if (json.type === 'message') {\n        chatHistory.push(json.data);\n\n        _this.setState({\n          chatHistory: chatHistory\n        });\n      } else {\n        _this.setState(function (prev) {\n          return _objectSpread({}, prev, _defineProperty({}, json.type, json.data));\n        });\n      }\n    };\n\n    _this.handleInputChange = function (e) {\n      _this.setState({\n        input: e.target.value\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(Chat, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      document.addEventListener('keydown', this.handleSubmit);\n      this._MO = new MutationObserver(this.scrollToBottom);\n\n      this._MO.observe(this._message.current, {\n        childList: true\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          name = _this$state.name,\n          chatHistory = _this$state.chatHistory,\n          color = _this$state.color,\n          input = _this$state.input,\n          status = _this$state.status,\n          error = _this$state.error;\n      return React.createElement(Wrapper, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, React.createElement(Messages, {\n        ref: this._message,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, React.createElement(Status, {\n        status: status,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, status, name && React.createElement(Name, {\n        color: color,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, \"as : \".concat(name)), error !== '' && \" : \".concat(error)), chatHistory.map(function (m) {\n        return React.createElement(Spring, {\n          from: {\n            x: -100\n          },\n          to: {\n            x: 0\n          },\n          config: {\n            tension: 280,\n            friction: 25\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 180\n          },\n          __self: this\n        }, function (p) {\n          return React.createElement(Msg, {\n            style: {\n              left: \"\".concat(p.x, \"%\")\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 182\n            },\n            __self: this\n          }, React.createElement(Author, {\n            color: m.color,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 183\n            },\n            __self: this\n          }, \"\".concat(m.author, \" [\").concat(new Date(m.time).toLocaleTimeString(), \"] : \")), m.text);\n        });\n      })), React.createElement(Input, {\n        ref: this._input,\n        type: \"text\",\n        value: input,\n        onChange: function onChange(e) {\n          return _this2.handleInputChange(e);\n        },\n        placeholder: name ? 'Enter your name' : 'Your Message ...',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Chat;\n}(React.Component);\n\nexport default Chat;","map":{"version":3,"sources":["/Users/clement/web/chat-ws/chat/src/components/Chat.js"],"names":["React","styled","Spring","config","Wrapper","div","Status","p","status","Name","color","Messages","Msg","Author","Input","input","Chat","_connection","_input","createRef","_message","_MO","state","error","chatHistory","name","scrollToBottom","current","scrollTop","scrollHeight","componentWillMount","connection","props","onopen","handleConnectionOpen","onerror","handleConnectionError","onmessage","handleConnectionMessage","handleSubmit","e","v","value","keyCode","send","setState","prev","err","console","log","msg","json","JSON","parse","data","type","push","handleInputChange","target","document","addEventListener","MutationObserver","observe","childList","map","m","x","tension","friction","left","author","Date","time","toLocaleTimeString","text","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport styled from 'styled-components'\nimport { Spring, config } from 'react-spring'\n\nconst Wrapper = styled.div`\n  width: 100vw;\n  height: 100vh;\n  background: #424242;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  font-size: 16px;\n  color: #fff;\n  font-family: Arial, sans-serif;\n\n  & > * {\n    padding: 10px;\n    border: 3px solid #fff;\n    border-radius: 3px;\n  }\n`\n\nconst Status = styled.div`\n    color: ${p =>\n      p.status === 'disconnected' ? 'red' : p.status === 'connection ...' ? 'orange' : 'green'}\n    font-weight: 600;\n    font-size: 18px;\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    right: 0px;\n    padding: 10px;\n    border: 2px solid #fff;\n    display: flex;\n    background-color: #424242;\n`\n\nconst Name = styled.div`\n    color: ${p => p.color}\n    font-size: 18px;\n    margin-left: 5px;\n`\n\nconst Messages = styled.div`\n  flex-grow: 1;\n  padding: 40px 0;\n  overflow-y: scroll;\n`\n\nconst Msg = styled.div`\n  color: #fff;\n  font-size: 16px;\n  padding: 20px 0 20px 10px;\n  display: flex;\n  border-bottom: 1px solid #cfcfcf;\n  position: relative;\n`\n\nconst Author = styled.div`\n  color: ${p => p.color};\n  font-size: 16px;\n  font-weight: 600;\n  margin-right: 10px;\n`\n\nconst Input = styled.input`\n  background-color: #424242;\n  color: #fff;\n  width: 100%;\n  height: 40px;\n  box-sizing: border-box;\n  &:focus {\n    outline: none;\n  }\n\n  &:-webkit-autofill,\n  &:-webkit-autofill:hover,\n  &:-webkit-autofill:focus,\n  &:-webkit-autofill:active {\n    transition: all 5000s ease-in-out 0s;\n  }\n`\nclass Chat extends React.Component {\n  _connection = null\n  _input = React.createRef()\n  _message = React.createRef()\n  _MO = null\n\n  state = {\n    status: '',\n    error: '',\n    chatHistory: [],\n    input: '',\n    name: null,\n    color: '',\n  }\n\n  scrollToBottom = () => {\n    this._message.current.scrollTop = this._message.current.scrollHeight\n  }\n\n  componentWillMount = () => {\n    const { connection } = this.props\n    this._connection = connection\n    this._connection.onopen = this.handleConnectionOpen\n    this._connection.onerror = this.handleConnectionError\n    this._connection.onmessage = this.handleConnectionMessage\n  }\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleSubmit)\n    this._MO = new MutationObserver(this.scrollToBottom)\n    this._MO.observe(this._message.current, { childList: true })\n  }\n\n  handleSubmit = e => {\n    const v = this._input.current.value\n\n    const { name } = this.state\n\n    if (v !== '' && e.keyCode === 13) {\n      this._connection.send(v)\n\n      this.setState(prev => ({\n        name: prev.name ? prev.name : v,\n        input: '',\n        status: 'connected',\n      }))\n    }\n  }\n\n  handleConnectionOpen = () => {\n    this.setState({ status: 'connection ...' })\n  }\n\n  handleConnectionError = err => {\n    console.log('connection error', err)\n    this.setState({\n      status: 'disconnected',\n      error: 'Connection failed',\n    })\n  }\n\n  handleConnectionMessage = msg => {\n    let { chatHistory } = this.state\n\n    try {\n      var json = JSON.parse(msg.data)\n    } catch (e) {\n      console.log('Invalid JSON: ', msg.data)\n      return\n    }\n\n    if (json.type === 'message') {\n      chatHistory.push(json.data)\n      this.setState({ chatHistory })\n    } else {\n      this.setState(prev => ({\n        ...prev,\n        [json.type]: json.data,\n      }))\n    }\n  }\n\n  handleInputChange = e => {\n    this.setState({ input: e.target.value })\n  }\n\n  render() {\n    const { name, chatHistory, color, input, status, error } = this.state\n    return (\n      <Wrapper>\n        <Messages ref={this._message}>\n          <Status status={status}>\n            {status}\n            {name && <Name color={color}>{`as : ${name}`}</Name>}\n            {error !== '' && ` : ${error}`}\n          </Status>\n          {chatHistory.map(m => (\n            <Spring from={{ x: -100 }} to={{ x: 0 }} config={{ tension: 280, friction: 25 }}>\n              {p => (\n                <Msg style={{ left: `${p.x}%` }}>\n                  <Author color={m.color}>{`${m.author} [${new Date(\n                    m.time,\n                  ).toLocaleTimeString()}] : `}</Author>\n                  {m.text}\n                </Msg>\n              )}\n            </Spring>\n          ))}\n        </Messages>\n        <Input\n          ref={this._input}\n          type=\"text\"\n          value={input}\n          onChange={e => this.handleInputChange(e)}\n          placeholder={name ? 'Enter your name' : 'Your Message ...'}\n        />\n      </Wrapper>\n    )\n  }\n}\n\nexport default Chat\n"]},"metadata":{},"sourceType":"module"}